The secure code provided implements session-based authentication and authorization checks in the /update-role route.
The primary security feature in this code is the prevention of unauthorized access and privilege escalation.
In the secure version, before updating a user's role, the application checks if the request initiator is authenticated (by checking req.session.userId) and authorized (by ensuring the user has an admin role). 
These checks prevent unauthorized access and ensure that only users with the proper permissions can update roles, thus mitigating the risks of unauthorized actions and privilege escalation.